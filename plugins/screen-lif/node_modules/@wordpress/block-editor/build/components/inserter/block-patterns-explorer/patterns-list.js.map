{"version":3,"names":["_element","require","_i18n","_compose","_components","_a11y","_blockPatternsList","_interopRequireDefault","_useInsertionPoint","_usePatternsState","_inserterListbox","_searchItems","_blockPatternsPaging","_usePatternsPaging","_blockPatternsTab","_blockPatternsSyncFilter","_blockPatternsSourceFilter","PatternsListHeader","filterValue","filteredBlockPatternsLength","selectedCategory","patternCategories","filter","allPatternsCategory","name","category","find","patternCategory","label","createElement","__experimentalHeading","level","lineHeight","className","sprintf","_n","PatternList","searchValue","patternSourceFilter","patternSyncFilter","setPatternSyncFilter","useState","container","useRef","debouncedSpeak","useDebounce","speak","destinationRootClientId","onInsertBlocks","useInsertionPoint","shouldFocusBlock","patterns","onClickPattern","usePatternsState","registeredPatternCategories","useMemo","map","filteredBlockPatterns","filteredPatterns","pattern","isPatternFiltered","hasKnownCategory","categories","some","includes","length","searchItems","useEffect","count","resultsFoundMessage","pagingProps","usePatternsPaging","hasItems","ref","PATTERN_SOURCE_FILTERS","default","PATTERN_TYPES","user","BlockPatternsSyncFilter","shownPatterns","categoryPatternsAsyncList","blockPatterns","categoryPatterns","isDraggable","numPages","_default","exports"],"sources":["@wordpress/block-editor/src/components/inserter/block-patterns-explorer/patterns-list.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useMemo, useEffect, useRef, useState } from '@wordpress/element';\nimport { _n, sprintf } from '@wordpress/i18n';\nimport { useDebounce } from '@wordpress/compose';\nimport { __experimentalHeading as Heading } from '@wordpress/components';\nimport { speak } from '@wordpress/a11y';\n\n/**\n * Internal dependencies\n */\nimport BlockPatternsList from '../../block-patterns-list';\nimport useInsertionPoint from '../hooks/use-insertion-point';\nimport usePatternsState from '../hooks/use-patterns-state';\nimport InserterListbox from '../../inserter-listbox';\nimport { searchItems } from '../search-items';\nimport BlockPatternsPaging from '../../block-patterns-paging';\nimport usePatternsPaging from '../hooks/use-patterns-paging';\nimport { allPatternsCategory, isPatternFiltered } from '../block-patterns-tab';\nimport { BlockPatternsSyncFilter } from '../block-patterns-sync-filter';\nimport {\n\tPATTERN_TYPES,\n\tPATTERN_SOURCE_FILTERS,\n} from '../block-patterns-source-filter';\n\nfunction PatternsListHeader( {\n\tfilterValue,\n\tfilteredBlockPatternsLength,\n\tselectedCategory,\n\tpatternCategories,\n} ) {\n\tif ( ! filterValue ) {\n\t\treturn null;\n\t}\n\tlet filter = filterValue;\n\tif ( selectedCategory !== allPatternsCategory.name ) {\n\t\tconst category = patternCategories.find(\n\t\t\t( patternCategory ) => patternCategory.name === selectedCategory\n\t\t);\n\t\tif ( category ) {\n\t\t\tfilter = `${ filter } - ${ category?.label }`;\n\t\t}\n\t}\n\treturn (\n\t\t<Heading\n\t\t\tlevel={ 2 }\n\t\t\tlineHeight={ '48px' }\n\t\t\tclassName=\"block-editor-block-patterns-explorer__search-results-count\"\n\t\t>\n\t\t\t{ sprintf(\n\t\t\t\t/* translators: %d: number of patterns. %s: block pattern search query */\n\t\t\t\t_n(\n\t\t\t\t\t'%1$d pattern found for \"%2$s\"',\n\t\t\t\t\t'%1$d patterns found for \"%2$s\"',\n\t\t\t\t\tfilteredBlockPatternsLength\n\t\t\t\t),\n\t\t\t\tfilteredBlockPatternsLength,\n\t\t\t\tfilter\n\t\t\t) }\n\t\t</Heading>\n\t);\n}\n\nfunction PatternList( {\n\tsearchValue,\n\tpatternSourceFilter,\n\tselectedCategory,\n\tpatternCategories,\n} ) {\n\tconst [ patternSyncFilter, setPatternSyncFilter ] = useState( 'all' );\n\tconst container = useRef();\n\tconst debouncedSpeak = useDebounce( speak, 500 );\n\tconst [ destinationRootClientId, onInsertBlocks ] = useInsertionPoint( {\n\t\tshouldFocusBlock: true,\n\t} );\n\tconst [ patterns, , onClickPattern ] = usePatternsState(\n\t\tonInsertBlocks,\n\t\tdestinationRootClientId\n\t);\n\n\tconst registeredPatternCategories = useMemo(\n\t\t() =>\n\t\t\tpatternCategories.map(\n\t\t\t\t( patternCategory ) => patternCategory.name\n\t\t\t),\n\t\t[ patternCategories ]\n\t);\n\n\tconst filteredBlockPatterns = useMemo( () => {\n\t\tconst filteredPatterns = patterns.filter( ( pattern ) => {\n\t\t\tif (\n\t\t\t\tisPatternFiltered(\n\t\t\t\t\tpattern,\n\t\t\t\t\tpatternSourceFilter,\n\t\t\t\t\tpatternSyncFilter\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif ( selectedCategory === allPatternsCategory.name ) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif ( selectedCategory === 'uncategorized' ) {\n\t\t\t\tconst hasKnownCategory = pattern.categories.some(\n\t\t\t\t\t( category ) =>\n\t\t\t\t\t\tregisteredPatternCategories.includes( category )\n\t\t\t\t);\n\n\t\t\t\treturn ! pattern.categories?.length || ! hasKnownCategory;\n\t\t\t}\n\n\t\t\treturn pattern.categories?.includes( selectedCategory );\n\t\t} );\n\n\t\tif ( ! searchValue ) {\n\t\t\treturn filteredPatterns;\n\t\t}\n\n\t\treturn searchItems(\n\t\t\tfilteredPatterns,\n\t\t\tsearchValue,\n\t\t\tpatternSourceFilter\n\t\t);\n\t}, [\n\t\tsearchValue,\n\t\tpatternSourceFilter,\n\t\tpatterns,\n\t\tselectedCategory,\n\t\tregisteredPatternCategories,\n\t\tpatternSyncFilter,\n\t] );\n\n\t// Announce search results on change.\n\tuseEffect( () => {\n\t\tif ( ! searchValue ) {\n\t\t\treturn;\n\t\t}\n\t\tconst count = filteredBlockPatterns.length;\n\t\tconst resultsFoundMessage = sprintf(\n\t\t\t/* translators: %d: number of results. */\n\t\t\t_n( '%d result found.', '%d results found.', count ),\n\t\t\tcount\n\t\t);\n\t\tdebouncedSpeak( resultsFoundMessage );\n\t}, [ searchValue, debouncedSpeak, filteredBlockPatterns.length ] );\n\n\tconst pagingProps = usePatternsPaging(\n\t\tfilteredBlockPatterns,\n\t\tselectedCategory,\n\t\tcontainer,\n\t\tpatternSourceFilter\n\t);\n\n\tconst hasItems = !! filteredBlockPatterns?.length;\n\treturn (\n\t\t<div\n\t\t\tclassName=\"block-editor-block-patterns-explorer__list\"\n\t\t\tref={ container }\n\t\t>\n\t\t\t<PatternsListHeader\n\t\t\t\tfilterValue={\n\t\t\t\t\tsearchValue || PATTERN_SOURCE_FILTERS[ patternSourceFilter ]\n\t\t\t\t}\n\t\t\t\tfilteredBlockPatternsLength={ filteredBlockPatterns.length }\n\t\t\t\tselectedCategory={ selectedCategory }\n\t\t\t\tpatternCategories={ patternCategories }\n\t\t\t/>\n\n\t\t\t<InserterListbox>\n\t\t\t\t{ patternSourceFilter === PATTERN_TYPES.user &&\n\t\t\t\t\t! searchValue && (\n\t\t\t\t\t\t<BlockPatternsSyncFilter\n\t\t\t\t\t\t\tpatternSyncFilter={ patternSyncFilter }\n\t\t\t\t\t\t\tsetPatternSyncFilter={ setPatternSyncFilter }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\n\t\t\t\t{ hasItems && (\n\t\t\t\t\t<BlockPatternsList\n\t\t\t\t\t\tshownPatterns={ pagingProps.categoryPatternsAsyncList }\n\t\t\t\t\t\tblockPatterns={ pagingProps.categoryPatterns }\n\t\t\t\t\t\tonClickPattern={ onClickPattern }\n\t\t\t\t\t\tisDraggable={ false }\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t\t{ pagingProps.numPages > 1 && (\n\t\t\t\t\t<BlockPatternsPaging { ...pagingProps } />\n\t\t\t\t) }\n\t\t\t</InserterListbox>\n\t\t</div>\n\t);\n}\n\nexport default PatternList;\n"],"mappings":"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"}